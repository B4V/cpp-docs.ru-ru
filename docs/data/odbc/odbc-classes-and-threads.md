---
title: Потоки и классы ODBC | Документация Майкрософт
ms.custom: ''
ms.date: 11/04/2016
ms.technology:
- cpp-data
ms.topic: conceptual
dev_langs:
- C++
helpviewer_keywords:
- ODBC classes, and threads
- ODBC, multithreaded applications
- threading [MFC], ODBC support
ms.assetid: 16543926-7331-41a6-ba50-72288f2a61b7
author: mikeblome
ms.author: mblome
ms.workload:
- cplusplus
- data-storage
ms.openlocfilehash: ab115db1387adb71a69b735d676fa657d370752f
ms.sourcegitcommit: a9dcbcc85b4c28eed280d8e451c494a00d8c4c25
ms.translationtype: MT
ms.contentlocale: ru-RU
ms.lasthandoff: 10/25/2018
ms.locfileid: "50052477"
---
# <a name="odbc-classes-and-threads"></a>Потоки и классы ODBC

Начиная с версии 4.2 MFC, имеется поддержка многопоточности для классам ODBC библиотеки MFC. Обратите внимание, что MFC не поддерживает многопоточность для классов DAO.

Поддержка многопоточности для классов ODBC имеет некоторые ограничения. Эти классы заключают в себе API-Интерфейс ODBC, они ограничены многопоточности компонентов, на которых они построены. Например многие драйверы ODBC не являются поточно ориентированными; Таким образом классы MFC ODBC не являются поточно ориентированными, если они используются с одним из этих драйверов. Вы должны проверить, является ли конкретного драйвера поточно ориентированные.

При создании многопоточного приложения, следует очень тщательно с помощью нескольких потоков для управления объектом. Например, используя то же `CRecordset` объекта в двух потоков может привести к проблемам при получении данных; операция выборки в один поток может перезаписать данные, полученные в другой поток. Более общие классы MFC ODBC в отдельных потоках используется для совместно используется открытый `CDatabase` нескольких потоках, чтобы использовать то же соединение ODBC, с отдельным `CRecordset` объекта в каждом потоке. Обратите внимание, что не следует передавать неоткрытый `CDatabase` объект `CRecordset` объект в другом потоке.

> [!NOTE]
>  Если необходимо иметь несколько потоков для управления и тот же объект, необходимо реализовать соответствующие методы синхронизации, таких как критические секции. Имейте в виду, что определенные операции, такие как `Open`, не защищены. Следует убедиться, что эти операции не вызываются одновременно из разных потоков.

Дополнительные сведения о создании многопоточных приложений см. в разделе [разделах, посвященных многопоточности](../../parallel/multithreading-support-for-older-code-visual-cpp.md).

## <a name="see-also"></a>См. также

[Интерфейс ODBC](../../data/odbc/open-database-connectivity-odbc.md)<br/>
[Доступ к данным, программирование (MFC/ATL)](../../data/data-access-programming-mfc-atl.md)